import logging
from datetime import datetime
from pprint import pprint
from typing import TypedDict, List

import pytz


class Appointment(TypedDict):
    appointmentInstance: int
    branch: str
    branchOfSchool: int
    cancelled: bool
    changeDescription: str
    created: int
    end: int
    groups: List[str]
    groupsInDepartments: List[int]
    hidden: bool
    id: int
    lastModified: int
    locations: List[str]
    locationsOfBranch: List[int]
    modified: bool
    moved: bool
    new: bool
    remark: str
    start: int
    subjects: List[str]
    teachers: List[str]
    type: str
    valid: bool

    endTimeSlot: int
    endTimeSlotName: str
    startTimeSlot: int
    startTimeSlotName: str


class Response(TypedDict):
    data: List[Appointment]
    details: str
    endRow: int
    eventId: int
    message: str
    startRow: int
    status: int
    totalRows: int


class WrappedResponse(TypedDict):
    response: Response


type timeslot = dict[str, int]


class ProcessedAppointments(TypedDict):
    timeslots: dict[str, timeslot]
    daily_appointments: dict[str, List[Appointment]]
    days: list[str]


user_1: WrappedResponse = {'response':
    {'data': [
        {'appointmentInstance': 2022345,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727784900,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.econ2'],
         'groupsInDepartments': [37552],
         'hidden': False,
         'id': 3547456,
         'lastModified': 1726213937,
         'locations': ['102'],
         'locationsOfBranch': [12684],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727782200,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['econ'],
         'teachers': ['jlt'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022581,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727867400,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547572,
         'lastModified': 1725371027,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727864700,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022462,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727871300,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.fi1'],
         'groupsInDepartments': [33203],
         'hidden': False,
         'id': 3547584,
         'lastModified': 1726213229,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727868600,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['fi'],
         'teachers': ['dkj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022658,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727953800,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.entl1'],
         'groupsInDepartments': [33129],
         'hidden': False,
         'id': 3547683,
         'lastModified': 1726150149,
         'locations': ['008'],
         'locationsOfBranch': [12678],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727951100,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['entl'],
         'teachers': ['hns'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022216,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727765100,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.nat2'],
         'groupsInDepartments': [33157],
         'hidden': False,
         'id': 3547362,
         'lastModified': 1726739981,
         'locations': ['105'],
         'locationsOfBranch': [12661],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727762400,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['nat'],
         'teachers': ['wee'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022617,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727944500,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547657,
         'lastModified': 1726150155,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727941800,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021944,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727771700,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5.biol1'],
         'groupsInDepartments': [33193],
         'hidden': False,
         'id': 3547383,
         'lastModified': 1725371027,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727769000,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['biol'],
         'teachers': ['rar'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022649,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727963400,
         'endTimeSlot': 9,
         'endTimeSlotName': 'u09',
         'groups': ['g5.wisd1', 'g6.wisd1', 'g4.wisd1'],
         'groupsInDepartments': [35606, 33149, 33124],
         'hidden': False,
         'id': 3547755,
         'lastModified': 1726739991,
         'locations': ['marienburg_m222'],
         'locationsOfBranch': [13752],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727959800,
         'startTimeSlot': 9,
         'startTimeSlotName': 'u09',
         'subjects': ['wisD'],
         'teachers': ['hsg'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022545,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728030900,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547798,
         'lastModified': 1726150155,
         'locations': ['sp'],
         'locationsOfBranch': [12687],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728028200,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['lo'],
         'teachers': ['fao'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022079,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727774400,
         'endTimeSlot': 4,
         'endTimeSlotName': 'u04',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547297,
         'lastModified': 1726150154,
         'locations': ['205'],
         'locationsOfBranch': [12692],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727771700,
         'startTimeSlot': 4,
         'startTimeSlotName': 'u04',
         'subjects': ['netl'],
         'teachers': ['laa'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2020715,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727694600,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547409,
         'lastModified': 1726150154,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727691900,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['glv'],
         'teachers': ['hnj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022354,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728027000,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.schk2'],
         'groupsInDepartments': [33158],
         'hidden': False,
         'id': 3547788,
         'lastModified': 1726213686,
         'locations': ['110'],
         'locationsOfBranch': [12693],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728024300,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['schk'],
         'teachers': ['bkm'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022600,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728040200,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.kubv1'],
         'groupsInDepartments': [33113],
         'hidden': False,
         'id': 3547848,
         'lastModified': 1726213229,
         'locations': ['009'],
         'locationsOfBranch': [12690],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728037500,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['kubv'],
         'teachers': ['laj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022336,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727851500,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547489,
         'lastModified': 1726150155,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727848800,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021981,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727678700,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547217,
         'lastModified': 1725371027,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727676000,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022603,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727864700,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547558,
         'lastModified': 1726150155,
         'locations': ['004'],
         'locationsOfBranch': [12691],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727862000,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['maat'],
         'teachers': ['brr'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021272,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728037500,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5.kubv1'],
         'groupsInDepartments': [33113],
         'hidden': False,
         'id': 3547833,
         'lastModified': 1726213229,
         'locations': ['009'],
         'locationsOfBranch': [12690],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728034800,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['kubv'],
         'teachers': ['laj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022532,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727951100,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5.fi1'],
         'groupsInDepartments': [33203],
         'hidden': False,
         'id': 3547702,
         'lastModified': 1726213229,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727948400,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['fi'],
         'teachers': ['dkj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022361,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727874000,
         'endTimeSlot': 8,
         'endTimeSlotName': 'u08',
         'groups': ['g5.fi1'],
         'groupsInDepartments': [33203],
         'hidden': False,
         'id': 3547602,
         'lastModified': 1726213229,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727871300,
         'startTimeSlot': 8,
         'startTimeSlotName': 'u08',
         'subjects': ['fi'],
         'teachers': ['dkj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022564,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728040200,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.econ2'],
         'groupsInDepartments': [37552],
         'hidden': False,
         'id': 3547845,
         'lastModified': 1726213937,
         'locations': ['102'],
         'locationsOfBranch': [12684],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728037500,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['econ'],
         'teachers': ['jlt'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022660,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728033600,
         'endTimeSlot': 4,
         'endTimeSlotName': 'u04',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547816,
         'lastModified': 1726150155,
         'locations': ['sp'],
         'locationsOfBranch': [12687],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728030900,
         'startTimeSlot': 4,
         'startTimeSlotName': 'u04',
         'subjects': ['lo'],
         'teachers': ['fao'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022629,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727937900,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.biol1'],
         'groupsInDepartments': [33193],
         'hidden': False,
         'id': 3547618,
         'lastModified': 1725371027,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727935200,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['biol'],
         'teachers': ['rar'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022409,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728024300,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.schk2'],
         'groupsInDepartments': [33158],
         'hidden': False,
         'id': 3547769,
         'lastModified': 1726213686,
         'locations': ['110'],
         'locationsOfBranch': [12693],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728021600,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['schk'],
         'teachers': ['bkm'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022252,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727685300,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547277,
         'lastModified': 1726150154,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727682600,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['maat'],
         'teachers': ['brr'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021842,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727701200,
         'endTimeSlot': 8,
         'endTimeSlotName': 'u08',
         'groups': ['g5.men1'],
         'groupsInDepartments': [33164],
         'hidden': False,
         'id': 3547339,
         'lastModified': 1725371027,
         'locations': ['004'],
         'locationsOfBranch': [12691],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727698500,
         'startTimeSlot': 8,
         'startTimeSlotName': 'u08',
         'subjects': ['men'],
         'teachers': ['brr'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022478,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727858100,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5.entl1'],
         'groupsInDepartments': [33129],
         'hidden': False,
         'id': 3547513,
         'lastModified': 1725520356,
         'locations': ['008'],
         'locationsOfBranch': [12678],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727855400,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['entl'],
         'teachers': ['hns'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021899,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727681400,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547231,
         'lastModified': 1725371027,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727678700,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022614,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727778300,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547436,
         'lastModified': 1726150155,
         'locations': ['205'],
         'locationsOfBranch': [12692],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727775600,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['netl'],
         'teachers': ['laa'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022638,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727940600,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.biol1'],
         'groupsInDepartments': [33193],
         'hidden': False,
         'id': 3547629,
         'lastModified': 1725371027,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727937900,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['biol'],
         'teachers': ['rar'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021936,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727691900,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547313,
         'lastModified': 1726150154,
         'locations': ['205'],
         'locationsOfBranch': [12692],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727689200,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['netl'],
         'teachers': ['laa'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022411,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728037500,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5.econ2'],
         'groupsInDepartments': [37552],
         'hidden': False,
         'id': 3547829,
         'lastModified': 1726213937,
         'locations': ['102'],
         'locationsOfBranch': [12684],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728034800,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['econ'],
         'teachers': ['jlt'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022633,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727784900,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.kubv1'],
         'groupsInDepartments': [33113],
         'hidden': False,
         'id': 3547461,
         'lastModified': 1726213229,
         'locations': ['007'],
         'locationsOfBranch': [12674],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727782200,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['kubv'],
         'teachers': ['laj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021957,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727767800,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.nat2'],
         'groupsInDepartments': [33157],
         'hidden': False,
         'id': 3547378,
         'lastModified': 1726213937,
         'locations': ['105'],
         'locationsOfBranch': [12661],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727765100,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['nat'],
         'teachers': ['wee'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022359,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727854200,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547506,
         'lastModified': 1726150155,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727851500,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022582,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727957700,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547723,
         'lastModified': 1726150149,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727955000,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021836,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727698500,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547332,
         'lastModified': 1726150154,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727695800,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True}],
        'details': '',
        'endRow': 36,
        'eventId': 0,
        'message': '',
        'startRow': 0,
        'status': 200,
        'totalRows': 36}}
user_2: WrappedResponse = {'response':
    {'data': [
        {'appointmentInstance': 2022345,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727784900,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.econ2'],
         'groupsInDepartments': [37552],
         'hidden': False,
         'id': 3547456,
         'lastModified': 1726213937,
         'locations': ['102'],
         'locationsOfBranch': [12684],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727782200,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['econ'],
         'teachers': ['jlt'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022581,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727867400,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547572,
         'lastModified': 1725371027,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727864700,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022462,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727871300,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.fi1'],
         'groupsInDepartments': [33203],
         'hidden': False,
         'id': 3547584,
         'lastModified': 1726213229,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727868600,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['fi'],
         'teachers': ['dkj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022658,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727953800,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.entl1'],
         'groupsInDepartments': [33129],
         'hidden': False,
         'id': 3547683,
         'lastModified': 1726150149,
         'locations': ['008'],
         'locationsOfBranch': [12678],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727951100,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['entl'],
         'teachers': ['hns'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022216,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727765100,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.nat2'],
         'groupsInDepartments': [33157],
         'hidden': False,
         'id': 3547362,
         'lastModified': 1726739981,
         'locations': ['105'],
         'locationsOfBranch': [12661],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727762400,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['nat'],
         'teachers': ['wee'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022617,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727944500,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547657,
         'lastModified': 1726150155,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727941800,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021944,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727771700,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5.biol1'],
         'groupsInDepartments': [33193],
         'hidden': False,
         'id': 3547383,
         'lastModified': 1725371027,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727769000,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['biol'],
         'teachers': ['rar'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022649,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727963400,
         'endTimeSlot': 9,
         'endTimeSlotName': 'u09',
         'groups': ['g5.wisd1', 'g6.wisd1', 'g4.wisd1'],
         'groupsInDepartments': [35606, 33149, 33124],
         'hidden': False,
         'id': 3547755,
         'lastModified': 1726739991,
         'locations': ['marienburg_m222'],
         'locationsOfBranch': [13752],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727959800,
         'startTimeSlot': 9,
         'startTimeSlotName': 'u09',
         'subjects': ['wisD'],
         'teachers': ['hsg'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022545,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728030900,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547798,
         'lastModified': 1726150155,
         'locations': ['sp'],
         'locationsOfBranch': [12687],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728028200,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['lo'],
         'teachers': ['fao'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022079,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727774400,
         'endTimeSlot': 4,
         'endTimeSlotName': 'u04',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547297,
         'lastModified': 1726150154,
         'locations': ['205'],
         'locationsOfBranch': [12692],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727771700,
         'startTimeSlot': 4,
         'startTimeSlotName': 'u04',
         'subjects': ['netl'],
         'teachers': ['laa'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2020715,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727694600,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547409,
         'lastModified': 1726150154,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727691900,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['glv'],
         'teachers': ['hnj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022354,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728027000,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.schk2'],
         'groupsInDepartments': [33158],
         'hidden': False,
         'id': 3547788,
         'lastModified': 1726213686,
         'locations': ['110'],
         'locationsOfBranch': [12693],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728024300,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['schk'],
         'teachers': ['bkm'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022600,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728040200,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.kubv1'],
         'groupsInDepartments': [33113],
         'hidden': False,
         'id': 3547848,
         'lastModified': 1726213229,
         'locations': ['009'],
         'locationsOfBranch': [12690],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728037500,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['kubv'],
         'teachers': ['laj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022336,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727851500,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547489,
         'lastModified': 1726150155,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727848800,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021981,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727678700,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547217,
         'lastModified': 1725371027,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727676000,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022603,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727864700,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547558,
         'lastModified': 1726150155,
         'locations': ['004'],
         'locationsOfBranch': [12691],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727862000,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['maat'],
         'teachers': ['brr'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021272,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728037500,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5.kubv1'],
         'groupsInDepartments': [33113],
         'hidden': False,
         'id': 3547833,
         'lastModified': 1726213229,
         'locations': ['009'],
         'locationsOfBranch': [12690],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728034800,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['kubv'],
         'teachers': ['laj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022532,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727951100,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5.fi1'],
         'groupsInDepartments': [33203],
         'hidden': False,
         'id': 3547702,
         'lastModified': 1726213229,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727948400,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['fi'],
         'teachers': ['dkj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022361,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727874000,
         'endTimeSlot': 8,
         'endTimeSlotName': 'u08',
         'groups': ['g5.fi1'],
         'groupsInDepartments': [33203],
         'hidden': False,
         'id': 3547602,
         'lastModified': 1726213229,
         'locations': ['101'],
         'locationsOfBranch': [12667],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727871300,
         'startTimeSlot': 8,
         'startTimeSlotName': 'u08',
         'subjects': ['fi'],
         'teachers': ['dkj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022564,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728040200,
         'endTimeSlot': 6,
         'endTimeSlotName': 'u06',
         'groups': ['g5.econ2'],
         'groupsInDepartments': [37552],
         'hidden': False,
         'id': 3547845,
         'lastModified': 1726213937,
         'locations': ['102'],
         'locationsOfBranch': [12684],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728037500,
         'startTimeSlot': 6,
         'startTimeSlotName': 'u06',
         'subjects': ['econ'],
         'teachers': ['jlt'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022660,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728033600,
         'endTimeSlot': 4,
         'endTimeSlotName': 'u04',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547816,
         'lastModified': 1726150155,
         'locations': ['sp'],
         'locationsOfBranch': [12687],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728030900,
         'startTimeSlot': 4,
         'startTimeSlotName': 'u04',
         'subjects': ['lo'],
         'teachers': ['fao'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022629,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727937900,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.biol1'],
         'groupsInDepartments': [33193],
         'hidden': False,
         'id': 3547618,
         'lastModified': 1725371027,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727935200,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['biol'],
         'teachers': ['rar'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022409,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728024300,
         'endTimeSlot': 1,
         'endTimeSlotName': 'u01',
         'groups': ['g5.schk2'],
         'groupsInDepartments': [33158],
         'hidden': False,
         'id': 3547769,
         'lastModified': 1726213686,
         'locations': ['110'],
         'locationsOfBranch': [12693],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728021600,
         'startTimeSlot': 1,
         'startTimeSlotName': 'u01',
         'subjects': ['schk'],
         'teachers': ['bkm'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022252,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727685300,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547277,
         'lastModified': 1726150154,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727682600,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['maat'],
         'teachers': ['brr'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021842,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727701200,
         'endTimeSlot': 8,
         'endTimeSlotName': 'u08',
         'groups': ['g5.men1'],
         'groupsInDepartments': [33164],
         'hidden': False,
         'id': 3547339,
         'lastModified': 1725371027,
         'locations': ['004'],
         'locationsOfBranch': [12691],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727698500,
         'startTimeSlot': 8,
         'startTimeSlotName': 'u08',
         'subjects': ['men'],
         'teachers': ['brr'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022478,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727858100,
         'endTimeSlot': 3,
         'endTimeSlotName': 'u03',
         'groups': ['g5.entl1'],
         'groupsInDepartments': [33129],
         'hidden': False,
         'id': 3547513,
         'lastModified': 1725520356,
         'locations': ['008'],
         'locationsOfBranch': [12678],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727855400,
         'startTimeSlot': 3,
         'startTimeSlotName': 'u03',
         'subjects': ['entl'],
         'teachers': ['hns'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021899,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727681400,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547231,
         'lastModified': 1725371027,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727678700,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022614,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727778300,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547436,
         'lastModified': 1726150155,
         'locations': ['205'],
         'locationsOfBranch': [12692],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727775600,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['netl'],
         'teachers': ['laa'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022638,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727940600,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.biol1'],
         'groupsInDepartments': [33193],
         'hidden': False,
         'id': 3547629,
         'lastModified': 1725371027,
         'locations': ['107'],
         'locationsOfBranch': [12679],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727937900,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['biol'],
         'teachers': ['rar'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021936,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727691900,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5c'],
         'groupsInDepartments': [32572],
         'hidden': False,
         'id': 3547313,
         'lastModified': 1726150154,
         'locations': ['205'],
         'locationsOfBranch': [12692],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727689200,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['netl'],
         'teachers': ['laa'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022411,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1728037500,
         'endTimeSlot': 5,
         'endTimeSlotName': 'u05',
         'groups': ['g5.econ2'],
         'groupsInDepartments': [37552],
         'hidden': False,
         'id': 3547829,
         'lastModified': 1726213937,
         'locations': ['102'],
         'locationsOfBranch': [12684],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1728034800,
         'startTimeSlot': 5,
         'startTimeSlotName': 'u05',
         'subjects': ['econ'],
         'teachers': ['jlt'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022633,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727784900,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.kubv1'],
         'groupsInDepartments': [33113],
         'hidden': False,
         'id': 3547461,
         'lastModified': 1726213229,
         'locations': ['007'],
         'locationsOfBranch': [12674],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727782200,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['kubv'],
         'teachers': ['laj'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021957,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727767800,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.nat2'],
         'groupsInDepartments': [33157],
         'hidden': False,
         'id': 3547378,
         'lastModified': 1726213937,
         'locations': ['105'],
         'locationsOfBranch': [12661],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727765100,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['nat'],
         'teachers': ['wee'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022359,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727854200,
         'endTimeSlot': 2,
         'endTimeSlotName': 'u02',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547506,
         'lastModified': 1726150155,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727851500,
         'startTimeSlot': 2,
         'startTimeSlotName': 'u02',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2022582,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727957700,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.gtc1'],
         'groupsInDepartments': [33131],
         'hidden': False,
         'id': 3547723,
         'lastModified': 1726150149,
         'locations': ['114'],
         'locationsOfBranch': [12673],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727955000,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['gtc'],
         'teachers': ['rsi'],
         'type': 'lesson',
         'valid': True},
        {'appointmentInstance': 2021836,
         'branch': 'beyersnaude',
         'branchOfSchool': 3153,
         'cancelled': False,
         'changeDescription': '',
         'created': 1725275573,
         'end': 1727698500,
         'endTimeSlot': 7,
         'endTimeSlotName': 'u07',
         'groups': ['g5.wisb2'],
         'groupsInDepartments': [33189],
         'hidden': False,
         'id': 3547332,
         'lastModified': 1726150154,
         'locations': ['204'],
         'locationsOfBranch': [12680],
         'modified': False,
         'moved': False,
         'new': False,
         'remark': '',
         'start': 1727695800,
         'startTimeSlot': 7,
         'startTimeSlotName': 'u07',
         'subjects': ['wisB'],
         'teachers': ['prs'],
         'type': 'lesson',
         'valid': True}],
        'details': '',
        'endRow': 36,
        'eventId': 0,
        'message': '',
        'startRow': 0,
        'status': 200,
        'totalRows': 36}}


def is_valid_appointment(appointment: Appointment, user_id: str) -> bool:
    if not appointment.get('groups'):

        if not user_id in appointment.get('teachers'):
            logging.info(f'No group for appointment: {appointment}')
            logging.info(
                f'User not in teachers list for this appointment, skipping hour. (subjects: {appointment.get('subjects')})')
            return False
        else:
            logging.info(f'No group for this appointment but {user_id} is in teachers list: {appointment}')

    return True


def process_user_data(user_data: WrappedResponse, user_id: str) -> ProcessedAppointments:
    timeslots: dict[str, dict[str, int]] = {}
    daily_appointments: dict[str, list[Appointment]] = {}

    appointments = user_data.get('response').get('data')
    for appointment in appointments:

        if not is_valid_appointment(appointment, user_id):
            continue

        date = str(datetime.fromtimestamp(
            appointment.get('start'), tz=pytz.timezone('Europe/Amsterdam')).date()
                   )

        if not timeslots.get(date):
            timeslots[date] = {
                'start': appointment.get('startTimeSlot'),
                'end': appointment.get('endTimeSlot')
            }

        else:
            timeslots[date]['start'] = min(timeslots[date]['start'], appointment.get('startTimeSlot'))
            timeslots[date]['end'] = max(timeslots[date]['end'], appointment.get('endTimeSlot'))

        if not daily_appointments.get(date):
            daily_appointments[date] = []

        daily_appointments[date].append(appointment)

    return {
        'timeslots': timeslots,
        'daily_appointments': daily_appointments,
        'days': list(timeslots.keys())
    }

def get_common_gaps(data: list[ProcessedAppointments]):
    common_dates: set = set.intersection(*[set(user_data['days']) for user_data in data])
    common_dates: list[str] = sorted(list(common_dates))

    for date in common_dates:
        # Process each common date
        logging.info(f'Processing date: {date}')

        for user_data in data:
            day = user_data.get('daily_appointments').get(date)
            logging.info(f'Processing user')

            for appointment in day:
                logging.info(f'Appointment with slot {appointment.get('startTimeSlot')} - {appointment.get('endTimeSlot')}')



logging.basicConfig(level=logging.DEBUG)
processed_appointments = process_user_data(user_1, '605091')
get_common_gaps([processed_appointments, processed_appointments])